# Bash基础和shell

终端：附着在终端的接口程序： GUI, CLI

**bash特性：**
命令行展开： ~， ｛｝

命令别名： alias, unalias

命令历史：history

文件名通配：glob

....

## 特性一：命令Hash

缓存此前命令执行的结果，记住或者显示程序的，格式为键值形式，直接运行hash查看结果

-d COMMAND  ： 清空指定名的hash

-r	: 	清空所有hash结果

## 特性二：变量

程序 = 数据 + 指令 / 算法 + 数据结构

指令： 由程序文件提供，

数据： IO设备， 文件， 管道，变量

变量名 + 指向的内存空间

变量类型： 存储格式，表示的数据范围， 参与的运算。

bash 是弱类型变量， bash变量统统视为字符型， 变量无需事先声明,相当于把声明和赋值同时实现。

变量引用： ${var_name} , $var_name， “” 变量名会变为其值， ‘ ’：变量名不会被替换为其值。

变量类型：本地变量（当前shell进程），局部变量（某代码），环境变量（当前shell以及其子进程），位置参数变量（当执行脚本的shell进程传递的参数），特殊变量（sehll内置特殊功用， 如$），

###  环境变量

变量赋值的方法： 1. export name=value,   2. name=value  export name, 3. declare -x name=value

bash内置了很多环境变量， 通常为全大写字母，用于定义bash的工作环境。 如：PATH, PWD, HOME, UID, SHELL。

查看环境变量： 1. export 不带参数看所有， 2. declare -s,  3. print env , 4.env

撤销环境变量： unset name

### 只读变量

1.declare -r name , 2. readonly name 把变量设置为只读的，无法被重新赋值，并且不支持撤销。

存活时间只为当前的shell生命周期。

## 特性三：多命令执行

**无逻辑关系的话用** **分号 ；**隔开即可， COMMAND1;  COMMAND2; COMMAND3;.......

### 逻辑运算：

 结果只有真（true, yes, on）, 假（false，no, off）

与（&&）、或（||）、非（!）、异或（相同为0 ， 不相同则为1）、

## Shell脚本编程

### 编程语言的分类： 

**根据运行方式：**

编译运行： 源代码- 》 编译器- 》程序文件

解释执行：源代码-》运行的时候启动解释器，由解释器边解释边执行。

**根据是否调用外部的程序文件：**

shell脚本编程：利用系统上的命令及编程的组件进行

完整编程：利用库或编程组件进行

**编程模型：**

面向过程：以指令为中心组织代码，数据是服务于代码的。（顺序，选择，循环执行）

面向对象：以数据为中心来组织代码， 围绕数据来组织指令。（类class, ）实例化对象。

### shell脚本编程特性：

**过程式编程，解释执行，依赖于外部程序文件运行。**

脚本第一行顶格写， 给出shebang, 解释器路径， 用于指明解释执行当前脚本的解释器程序文件。

**常见的解释器有：**

```bash
#!/bin/bash
#!/usr/bin/python
#!/user/bin/perl
```

**文本编辑器：**

行编辑器：sed,

全屏编辑器： vim , nano

### 运行脚本

1. 赋予执行权限，并且直接运行此文件。
2. 直接运行解释器，将脚本一命令行参数传递个解释器程序， bash/sh xxx.sh

**echo $?** 可以查看上条命令的执行状态。

### bash的配置文件

**profile 类：** 为交互式登录的shell提供配置。 全局对所有的用户都生效， 如/etc/profile, /etc/profile.d/*.sh, 局部则是只对当前用户相关。~/.bash_profile （家目录下）. 功用主要用来**定义环境变量、运行命令或脚本**。**仅管理员才可以修改全局配置文件**

**bashrc 类**： 为非交互式登录的shell提供配置。全局：/etc/bashrc,  局部：~/.bashrc， 功用**定义本地变量， 定义命令别名。**

交互式： 直接通过某终端登录打开的shell进程，或者使用su -切换用户登录的shell进程

非交互式：su name 登录的打开的， 图形界面下打开的终端， 运行脚本。

**读取顺序：**

1. 交互式：/etc/profile - >> /etc/profile.d/* -->> ~/.bash_profile ---> /etc/bahsrc
2. 非交互式：~/.bashrc --> /etc/bashrc --/etc/profile.d/* .

让通过配置文件定义的特性立即生效：通过命令行重复定义一次， 或者使用**source** file。立即生效。 或者直接 **点号 .** file





